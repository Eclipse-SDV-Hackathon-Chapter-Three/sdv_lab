apiVersion: v0.1
workloads:
  #carla:
  #  runtime: podman
  #  agent: agent_A
  #  restartPolicy: ALWAYS
  #  runtimeConfig: |
  #    image: docker.io/carlasim/carla:latest
  #    commandOptions: ["--privileged", "--gpus", "all", "--net=host", "-v", "/tmp/.X11-unix:/tmp/.X11-unix:rw"]
  #    commandArgs: ["/bin/bash", "./CarlaUE4.sh", "-RenderOffScreen"]
  
  threadx_board_simulator:
    runtime: podman
    agent: agent_A
    restartPolicy: NEVER
    runtimeConfig: |
      image: threadx-board-simulator:v1
      commandOptions: ["--network", "host"]  
  mqtt_broker:
    runtime: podman
    agent: agent_A
    restartPolicy: NEVER
    configs:
      mqtt_conf: mqtt_config
    files:
      - mountPoint: /mosquittdd o/config/mosquitto.conf
        data: "{{mqtt_conf}}"
    runtimeConfig: |
      image: docker.io/library/eclipse-mosquitto:latest
      commandOptions: ["--network", "host", "-u", "mosquitto", "-v", "mosquitto_data:/mosquitto/data"]
  ustreamer:
    runtime: podman
    agent: agent_A
    restartPolicy: NEVER
    runtimeConfig: |
      image: ghcr.io/eclipse-uprotocol/up-streamer-rust/configurable-streamer:main
      commandOptions: ["--network", "host", "-e", "RUST_LOG=debug,zenoh=debug", "-v", "/home/rscosta/Documents/sdv_lab/ankaios/ustreamer:/app/config"]
configs:
  mqtt_config: |
    allow_anonymous true
    listener 1883 0.0.0.0
    persistence true
    persistence_location /mosquitto/data/